<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title><%= @title %> - YSFH Access</title>
        <style>
            * {
                box-sizing: border-box;
            }

            html, body {
                width: 100%;
                height: 100%;
            }
            
            #accessbar {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                height: 64px;

                background: rgba(0,115,186,1);
                background: -moz-linear-gradient(left, rgba(0,115,186,1) 0%, rgba(8,70,114,1) 100%);
                background: -webkit-gradient(left top, right top, color-stop(0%, rgba(0,115,186,1)), color-stop(100%, rgba(8,70,114,1)));
                background: -webkit-linear-gradient(left, rgba(0,115,186,1) 0%, rgba(8,70,114,1) 100%);
                background: -o-linear-gradient(left, rgba(0,115,186,1) 0%, rgba(8,70,114,1) 100%);
                background: -ms-linear-gradient(left, rgba(0,115,186,1) 0%, rgba(8,70,114,1) 100%);
                background: linear-gradient(to right, rgba(0,115,186,1) 0%, rgba(8,70,114,1) 100%);
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#0073ba', endColorstr='#084672', GradientType=1 );
                color: #666;
            }

            #accessbar a {
                display: inline-block;
            }

            #accessbar img {
                margin: 11px auto auto 11px;
                height: 42px;
            }

            #accessbar form {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                margin: 8px 120px auto 52px;
                height: 48px;
            }

            #url {
                position: absolute;
                width: 100%;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                font-size: 20px;
                padding: 4px;
                padding-left: 12px;
                padding-right: 96px; 
                border-radius: 4px;
                border: none;
                height: 100%;
            }

            #access-button {
                position: absolute;
                top: 0;
                right: 0;
                bottom: 0;
                font-size: 18px;
                background-color: hsl(327, 100%, 70%);
                color: white;
                width: 92px;
                border-top-right-radius: 4px;
                border-bottom-right-radius: 4px;
                border: none;
            }

            .js-switch {
                float: right;
                margin-right: 42px;
                margin-top: 8px;
            }

            .js-switch label {
                font-size: 12px;
                color: hsl(0, 0%, 100%);
            }

            .js-switch button {
                display: block;
                width: 100%;
                border: none;
                border-radius: 4px;
                background-color: hsl(106, 100%, 41%);
                color: hsl(0, 0%, 100%);
            }

            .js-switch button.js-disabled {
                background-color: hsl(327, 100%, 41%);
            }
            
            #view {
                position: fixed;
                left: 0;
                right: 0;
                bottom: 0;
                width: 100%;
                bottom: 0;
                height: calc(100% - 64px);
            } 
        </style>
        <script src="/ysfhaccess/base64.min.js"></script>
    </head>
    
    <body>
        <script>
            function jumped(doc) {
                document.title = doc.contentWindow.document.title + ' - YSFH Access';
                var b64ed = doc.contentWindow.location.pathname.substr(1);
                var search = doc.contentWindow.location.search;
                var viewURL = Base64.decode(b64ed) + search;
                document.getElementById('url').value = viewURL;
            }

            function access() {
                document.querySelector('#view').src = location.origin + '/' + Base64.encodeURI(document.querySelector('#url').value);
            }

            function switchJS(button) {
                var isJSDisabled = (button.className == 'js-disabled');
                var iframe = document.querySelector('iframe').contentWindow;
                if (isJSDisabled) {
                    button.className = '';
                    button.textContent = '有効';
                    iframe.document.cookie = 'js_disabled=false';
                } else {
                    button.className = 'js-disabled';
                    button.textContent = '無効';
                    iframe.document.cookie = 'js_disabled=true';
                }
            }
        </script>
        <div id="accessbar">
            <a href="/ysfhaccess"><img src="/ysfhaccess/favicon.ico"></a>
             <form>
                <input type="text" id="url" placeholder="http://..."><button id="access-button" onclick="access(); return false;">Access</button>
            </form>
            <div class="js-switch">
                <label>JavaScript</label>
                <button class="<%if @isJSDisabled : %>js-disabled<% end %>" onclick="switchJS(this);"><%if @isJSDisabled : %>無効<% else : %>有効<% end %></button>
            </div>
        </div>
        <iframe id="view" src="<%- @url %>" onload="jumped(this)">
        </iframe>
    </body>

</html>
